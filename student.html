<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Student Dashboard</title>

    <!-- Fonts & Icons -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />

    <!-- Theming boot (respect saved choice or system) -->
    <script>
      (function () {
        const saved = localStorage.getItem("theme");
        const isDark = saved
          ? saved === "dark"
          : window.matchMedia("(prefers-color-scheme: dark)").matches;
        if (isDark) document.documentElement.classList.add("dark-boot");
      })();
    </script>

    <!-- Theming + layout -->
    <style>
      /* ==== THEME TOKENS (from your two screenshots) ==== */
      :root {
        /* LIGHT (screenshot 2) */
        --bg: #edf3fb;
        --bgAccent: #e7effa;
        --card: #ffffff;
        --ink: #0f274b;
        --muted: #667491;
        --line: #dee6f3;

        --primary: #1c3d77;
        --primary-100: #eaf1ff;
        --accent: #7f91ff;

        /* CTA (gold buttons) */
        --cta: #e0b31a;
        --cta-hover: #cf9f14;
        --cta-ink: #0b0d14;

        /* layout/shadows/spacing */
        --r-lg: 22px;
        --r-md: 14px;
        --shadow: 0 10px 28px rgba(24, 37, 56, 0.08);
        --pad: clamp(20px, 3vw, 32px);
        --gap: clamp(24px, 3vw, 36px);
        --gap-sm: clamp(14px, 2vw, 20px);
        --content-max: 1200px;
        --sidebar-w: 260px;

        /* hero gradient (light) */
        --hero-start: #eef4ff;
        --hero-end: #e8f0ff;

        /* metric tints (light) */
        --metric-yellow: #fff4cc;
        --metric-yellow-ico: #ffe19a;
        --metric-purple: #ece4ff;
        --metric-purple-ico: #ddd2ff;
        --metric-pink: #ffe3f0;
        --metric-pink-ico: #ffd1e6;
        --metric-blue: #e4eeff;
        --metric-blue-ico: #d1e4ff;
      }

      body.dark {
        /* DARK (screenshot 1) */
        --bg: #0a142b;
        --bgAccent: #0d1b3b;
        --card: #0f1c3c;
        --ink: #e7eeff;
        --muted: #9fb3d6;
        --line: #1c2c56;

        --primary: #9db7ff;
        --primary-100: #172b59;
        --accent: #b8c6ff;

        /* CTA (gold stays for continuity) */
        --cta: #e0b31a;
        --cta-hover: #cf9f14;
        --cta-ink: #140e00;

        --shadow: 0 10px 28px rgba(0, 0, 0, 0.45);

        /* hero gradient (dark) */
        --hero-start: #0b1836;
        --hero-end: #0a1530;

        /* metric tints (dark) */
        --metric-yellow: #2b2715;
        --metric-yellow-ico: #3a3112;
        --metric-purple: #1c1c3b;
        --metric-purple-ico: #2a2956;
        --metric-pink: #351f2c;
        --metric-pink-ico: #452638;
        --metric-blue: #112243;
        --metric-blue-ico: #1a2d56;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      html,
      body {
        height: 100%;
      }
      body {
        font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto,
          sans-serif;
        background: radial-gradient(
          1100px 600px at 20% -10%,
          var(--bgAccent) 0%,
          var(--bg) 40%,
          var(--bg) 100%
        );
        color: var(--ink);
        transition: background 0.25s ease, color 0.25s ease;
      }
      /* ensure initial paint respects boot class */
      .dark-boot body {
        background: radial-gradient(
          1100px 600px at 20% -10%,
          var(--bgAccent) 0%,
          var(--bg) 40%,
          var(--bg) 100%
        );
      }

      /* Shell */
      .shell {
        display: grid;
        grid-template-columns: var(--sidebar-w) 1fr;
        min-height: 100svh;
      }

      /* Sidebar */
      .sidebar {
        background: color-mix(in oklab, var(--bg) 92%, black 0%);
        border-right: 1px solid var(--line);
        padding: 22px 16px;
        position: sticky;
        top: 0;
        height: 100svh;
        display: grid;
        grid-template-rows: auto 1fr auto;
        gap: var(--gap);
        transition: background 0.25s ease, border-color 0.25s ease;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 12px;
        border-radius: 16px;
        background: var(--card);
        border: 1px solid var(--line);
        box-shadow: var(--shadow);
        width: 100%;
        cursor: pointer;
        transition: background 0.25s ease, border-color 0.25s ease,
          transform 0.06s ease;
      }
      .brand:active {
        transform: translateY(1px);
      }
      .brand .logo {
        width: 36px;
        height: 36px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        background: linear-gradient(
          135deg,
          #6ea8ff 0%,
          #7e85ff 50%,
          #b06bff 100%
        );
        color: #fff;
        font-weight: 800;
        font-size: 18px;
      }
      .brand strong {
        letter-spacing: 0.2px;
      }
      .brand small {
        display: block;
        color: var(--muted);
        font-weight: 700;
      }

      .nav {
        margin-top: 6px;
      }
      .nav h5 {
        font-size: 12px;
        color: #7d8aa3;
        letter-spacing: 0.4px;
        margin: 6px 10px;
        text-transform: uppercase;
        font-weight: 800;
      }
      body.dark .nav h5 {
        color: #8fa3c7;
      }
      .nav ul {
        list-style: none;
        display: grid;
        gap: 6px;
      }
      .nav a {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 12px;
        border-radius: 12px;
        text-decoration: none;
        color: #3b4a5e;
        font-weight: 700;
        transition: background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
      }
      body.dark .nav a {
        color: #bfd0ee;
      }
      .nav a i {
        width: 20px;
        text-align: center;
      }
      .nav li.active a,
      .nav a:hover {
        background: color-mix(in oklab, var(--primary-100) 60%, white 0%);
        color: var(--primary);
        box-shadow: inset 0 0 0 1px
          color-mix(in oklab, var(--primary) 22%, var(--line));
      }
      body.dark .nav li.active a,
      body.dark .nav a:hover {
        background: var(--primary-100);
        color: #9db7ff;
        box-shadow: inset 0 0 0 1px #203055;
      }

      .sb-user {
        margin-top: auto;
        padding: 12px;
        border: 1px solid var(--line);
        border-radius: 16px;
        background: var(--card);
        transition: background 0.25s ease, border-color 0.25s ease;
      }
      .sb-user .row {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .avatar {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: #eef2ff;
        display: grid;
        place-items: center;
        font-weight: 800;
      }
      body.dark .avatar {
        background: #19274b;
        color: #c7d7ff;
      }
      .sb-user small {
        display: block;
        color: var(--muted);
        margin-top: 2px;
      }
      .logout {
        margin-top: 10px;
        width: 100%;
        padding: 10px 12px;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        background: #f1f5ff;
        color: #243b77;
        font-weight: 800;
      }
      body.dark .logout {
        background: #1a2850;
        color: #c7d7ff;
      }

      /* Main */
      .main {
        display: grid;
        grid-template-rows: auto 1fr;
        min-width: 0;
      }
      .top {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        padding: 12px calc(var(--pad) * 1.2);
        position: sticky;
        top: 0;
        z-index: 5;
        background: transparent;
      }
      .today {
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: 12px;
        padding: 10px 12px;
        color: var(--muted);
        font-weight: 700;
        box-shadow: var(--shadow);
      }

      /* Content container */
      .content {
        padding: clamp(24px, 4vw, 40px);
        display: flex;
        justify-content: center;
        padding-bottom: calc(var(--pad) * 1.25);
      }
      .inner {
        width: 100%;
        max-width: var(--content-max);
        display: grid;
        gap: clamp(28px, 4vw, 44px);
      }

      .page {
        display: none;
      }
      .page.active {
        display: block;
      }

      /* Card */
      .card {
        background: var(--card);
        border: 1px solid var(--line);
        border-radius: var(--r-lg);
        box-shadow: var(--shadow);
        overflow: hidden;
        transition: background 0.25s ease, border-color 0.25s ease,
          box-shadow 0.25s ease;
      }
      .card-body {
        padding: calc(var(--pad) + 6px);
      }

      /* ===== Dashboard styling ===== */
      .hero-banner {
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: center;
        background: linear-gradient(
          135deg,
          var(--hero-start) 0%,
          var(--hero-end) 100%
        );
        border: 1px solid var(--line);
        border-radius: 24px;
        box-shadow: var(--shadow);
        margin-bottom: clamp(18px, 2.5vw, 28px);
      }
      .hero-hello h1 {
        font-size: clamp(24px, 2.6vw, 32px);
        letter-spacing: 0.2px;
      }
      .hero-hello p {
        color: var(--muted);
        margin-top: 6px;
      }
      .hero-hello {
        padding: var(--pad);
      }
      .hero-art {
        display: grid;
        place-items: center;
        padding-right: 20px;
      }

      .section-title {
        font-size: 16px;
        font-weight: 800;
        color: #6b7080;
        letter-spacing: 0.3px;
        margin: 16px 4px 12px;
      }

      /* Overview pills */
      .metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin-top: 10px;
        margin-bottom: clamp(18px, 2.2vw, 26px);
      }
      .metric {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 18px 20px;
        border-radius: 16px;
        box-shadow: var(--shadow);
        color: var(--ink);
      }
      .metric .ico {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        display: grid;
        place-items: center;
        font-weight: 800;
      }
      .metric .num {
        font-size: 20px;
        font-weight: 900;
        line-height: 1;
      }
      .metric .lbl {
        font-weight: 700;
        color: #525f78;
        font-size: 12px;
        margin-top: 2px;
      }

      /* theme-aware metric colors */
      .metric.yellow {
        background: var(--metric-yellow);
      }
      .metric.yellow .ico {
        background: var(--metric-yellow-ico);
      }
      .metric.purple {
        background: var(--metric-purple);
      }
      .metric.purple .ico {
        background: var(--metric-purple-ico);
      }
      .metric.pink {
        background: var(--metric-pink);
      }
      .metric.pink .ico {
        background: var(--metric-pink-ico);
      }
      .metric.blue {
        background: var(--metric-blue);
      }
      .metric.blue .ico {
        background: var(--metric-blue-ico);
      }

      /* Chip pills */
      .chip {
        background: color-mix(
          in oklab,
          var(--card) 88%,
          var(--primary-100) 12%
        );
        border: 1px solid var(--line);
        padding: 9px 12px;
        border-radius: 12px;
        font-weight: 700;
        color: var(--ink);
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      body.dark .chip {
        background: color-mix(in oklab, var(--card) 70%, black 0%);
        border-color: var(--line);
      }
      a,
      .chip:hover {
        color: var(--primary);
      }

      /* Applications list styled like decks */
      .list {
        display: grid;
        gap: 18px;
      }
      .deck {
        display: grid;
        grid-template-columns: 56px 1fr auto;
        gap: 18px;
        align-items: center;
        padding: 20px;
        border: 1px solid var(--line);
        border-radius: 16px;
        background: var(--card);
      }
      .thumb {
        width: 56px;
        height: 56px;
        border-radius: 14px;
        display: grid;
        place-items: center;
        background: linear-gradient(135deg, #fee2e2, #ede9fe);
        color: #4b5563;
      }
      .deck h4 {
        font-size: 16px;
        margin-bottom: 2px;
      }
      .deck .meta {
        color: var(--muted);
        font-size: 12px;
      }
      .deck .side {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .status {
        padding: 6px 10px;
        border-radius: 10px;
        font-size: 12px;
        font-weight: 800;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .pending {
        background: #fff6e6;
        color: #92400e;
      }
      .approved {
        background: #e8f9ef;
        color: #166534;
      }
      .denied {
        background: #ffe9ea;
        color: #991b1b;
      }

      .bar {
        height: 8px;
        border-radius: 999px;
        background: #eef2ff;
        overflow: hidden;
        margin-top: 8px;
      }
      .bar > i {
        display: block;
        height: 100%;
        width: 0;
        background: linear-gradient(90deg, #5c7df5, #8b5cf6);
      }

      /* Profile form */
      .split {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 16px 24px;
      }
      label {
        font-size: 13px;
        font-weight: 700;
        color: #2c4057;
        margin-bottom: 6px;
        display: block;
      }
      body.dark label {
        color: #c7d7ff;
      }
      input {
        width: 100%;
        padding: 12px;
        border-radius: 12px;
        border: 1px solid var(--line);
        background: #f8fafe;
        outline: none;
        color: var(--ink);
        font-size: 14px;
      }
      body.dark input {
        background: #0f1831;
        color: #e6ecf7;
      }
      input:disabled {
        background: #f3f6fc;
        color: #8894a5;
        cursor: not-allowed;
      }
      body.dark input:disabled {
        background: #0e1530;
        color: #7890b7;
      }
      .form-actions {
        grid-column: 1/-1;
        display: flex;
        gap: 10px;
      }
      .btn {
        border: none;
        padding: 10px 14px;
        border-radius: 12px;
        font-weight: 800;
        cursor: pointer;
      }
      .btn.edit {
        background: #eaf3ff;
        color: #123b7a;
      }
      .btn.save {
        background: #d1fae5;
        color: #064e3b;
        display: none;
      }

      /* CTA variant (if needed) */
      .btn.cta {
        background: var(--cta);
        color: var(--cta-ink);
      }
      .btn.cta:hover {
        background: var(--cta-hover);
      }

      /* Responsive */
      @media (max-width: 1000px) {
        .hero-banner {
          grid-template-columns: 1fr;
        }
      }
      @media (max-width: 860px) {
        .shell {
          grid-template-columns: 80px 1fr;
        }
        .brand strong,
        .brand small {
          display: none;
        }
        .nav a span {
          display: none;
        }
        .nav a {
          justify-content: center;
        }
        .sb-user {
          display: none;
        }
      }
      @media (max-width: 640px) {
        .top {
          justify-content: space-between;
        }
        .today {
          width: 100%;
          text-align: center;
        }
      }

      /* vertical rhythm between section siblings */
      .page > * + * {
        margin-top: clamp(24px, 3vw, 36px);
      }
      /* ===== Dashboard styling ===== */

      .hero-banner {
        display: grid;
        grid-template-columns: 1fr auto;
      }

      .hero-hello h1 span {
        background: linear-gradient(90deg, #5c7df5, #8b5cf6);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .hero-banner {
        align-items: center;
      }

      .hero-hello {
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      /* existing next rule */
      .section-title {
        font-size: 16px;
        font-weight: 800;
        color: #6b7080;
      }

      /* Prevent scholarship styles from affecting dashboard */
      #scholarshipWrapper {
        all: revert-layer; /* resets all styles to avoid conflict */
        isolation: isolate;
        display: block;
      }

      .page {
        display: none;
        height: auto;
        min-height: 100%;
      }

      .page.active {
        display: block;
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <!-- Sidebar -->
      <aside class="sidebar">
        <button
          class="brand"
          id="modeToggle"
          aria-pressed="false"
          aria-label="Toggle theme"
        >
          <div class="logo" id="modeIcon">‚òÄÔ∏è</div>
          <div>
            <strong id="modeLabel">Light mode</strong>
            <small>Click to switch</small>
          </div>
        </button>

        <nav class="nav">
          <h5>Menu</h5>
          <ul>
            <li class="active" data-page="dash">
              <a href="#"
                ><i class="fa-solid fa-grip"></i><span>Dashboard</span></a
              >
            </li>
            <li data-page="profile">
              <a href="#"
                ><i class="fa-solid fa-user"></i><span>My Profile</span></a
              >
            </li>
            <li data-page="scholarships">
              <a href="#"
                ><i class="fa-solid fa-graduation-cap"></i
                ><span>Scholarships</span></a
              >
            </li>
            <li data-page="apps">
              <a href="#"
                ><i class="fa-solid fa-list-check"></i
                ><span>Applications</span></a
              >
            </li>
          </ul>
        </nav>

        <div class="sb-user">
          <div class="row">
            <div class="avatar" id="sbAvatar">üë§</div>
            <div>
              <strong id="sbName">Student</strong>
              <small id="sbStatus">Logged in</small>
            </div>
          </div>
          <button class="logout" id="logoutBtn">
            <i class="fa-solid fa-right-from-bracket"></i> Logout
          </button>
        </div>
      </aside>

      <!-- Main -->
      <main class="main">
        <div class="top">
          <div class="today" id="todayChip">‚Äî</div>
        </div>

        <div class="content">
          <div class="inner">
            <!-- DASHBOARD -->
            <section id="page-dash" class="page active">
              <!-- Hero banner -->
              <div class="card hero-banner">
                <div class="card-body" style="display: contents">
                  <div class="hero-hello">
                    <h1>Hi, <span id="hiName">there</span></h1>
                    <p>
                      Ready to start your day with some scholarship
                      applications?
                    </p>
                  </div>
                  <div class="hero-art" aria-hidden="true">
                    <svg
                      viewBox="0 0 140 140"
                      width="160"
                      height="160"
                      role="img"
                      aria-label="Mascot"
                    >
                      <defs>
                        <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
                          <stop stop-color="#6EA8FF" offset="0" />
                          <stop stop-color="#8B5CF6" offset="1" />
                        </linearGradient>
                      </defs>
                      <circle
                        cx="70"
                        cy="70"
                        r="60"
                        fill="#FFFFFF"
                        stroke="#E7EDF7"
                      />
                      <circle cx="50" cy="58" r="10" fill="#FFE7E7" />
                      <circle cx="90" cy="58" r="10" fill="#E7F1FF" />
                      <circle
                        cx="70"
                        cy="80"
                        r="28"
                        fill="#F6F9FF"
                        stroke="#E7EDF7"
                      />
                      <circle cx="60" cy="76" r="4" fill="#1F2A37" />
                      <circle cx="80" cy="76" r="4" fill="#1F2A37" />
                      <path
                        d="M55 88c9 9 21 9 30 0"
                        stroke="#1F2A37"
                        stroke-width="3"
                        stroke-linecap="round"
                      />
                      <rect
                        x="38"
                        y="100"
                        width="64"
                        height="12"
                        rx="6"
                        fill="url(#g)"
                      />
                    </svg>
                  </div>
                </div>
              </div>

              <!-- Overview pills -->
              <h3 class="section-title">Overview</h3>
              <div class="metrics">
                <div class="metric yellow">
                  <div class="ico">
                    <i class="fa-solid fa-circle-check"></i>
                  </div>
                  <div>
                    <div class="num" id="mApproved">‚Äî</div>
                    <div class="lbl">Approved</div>
                  </div>
                </div>
                <div class="metric purple">
                  <div class="ico"><i class="fa-regular fa-clock"></i></div>
                  <div>
                    <div class="num" id="mPending">‚Äî</div>
                    <div class="lbl">Pending</div>
                  </div>
                </div>
                <div class="metric pink">
                  <div class="ico"><i class="fa-solid fa-user-xmark"></i></div>
                  <div>
                    <div class="num" id="mRejected">‚Äî</div>
                    <div class="lbl">Rejected</div>
                  </div>
                </div>
                <div class="metric blue">
                  <div class="ico">
                    <i class="fa-solid fa-calendar-days"></i>
                  </div>
                  <div>
                    <div class="num" id="mUpcoming">3</div>
                    <div class="lbl">Upcoming Events</div>
                  </div>
                </div>
              </div>

              <!-- Notifications -->
              <div class="card noti">
                <div class="card-body">
                  <header
                    style="
                      display: flex;
                      align-items: center;
                      justify-content: space-between;
                    "
                  >
                    <h3 style="font-size: 18px">Notifications</h3>
                    <a
                      href="#"
                      style="
                        font-weight: 700;
                        color: var(--primary);
                        text-decoration: none;
                      "
                      >See all</a
                    >
                  </header>
                  <div
                    class="notis"
                    id="notiList"
                    style="margin-top: 16px; display: grid; gap: 16px"
                  >
                    <div
                      class="note"
                      style="
                        display: grid;
                        grid-template-columns: 36px 1fr auto;
                        align-items: center;
                        gap: 12px;
                        padding: 12px;
                        border-radius: 14px;
                        border: 1px solid var(--line);
                        background: color-mix(
                          in oklab,
                          var(--card) 96%,
                          white 4%
                        );
                      "
                    >
                      <div
                        class="dot yellow"
                        style="
                          width: 36px;
                          height: 36px;
                          border-radius: 12px;
                          display: grid;
                          place-items: center;
                          background: #fff7e6;
                          color: #9a6a00;
                        "
                      >
                        <i class="fa-regular fa-bell"></i>
                      </div>
                      <div>
                        <strong>You‚Äôve added a new project</strong>
                        <small style="display: block; color: var(--muted)"
                          >No deadline set yet</small
                        >
                      </div>
                      <i
                        class="fa-solid fa-ellipsis-vertical"
                        style="color: #9aa5b5"
                      ></i>
                    </div>
                    <div
                      class="note"
                      style="
                        display: grid;
                        grid-template-columns: 36px 1fr auto;
                        align-items: center;
                        gap: 12px;
                        padding: 12px;
                        border-radius: 14px;
                        border: 1px solid var(--line);
                        background: color-mix(
                          in oklab,
                          var(--card) 96%,
                          white 4%
                        );
                      "
                    >
                      <div
                        class="dot red"
                        style="
                          width: 36px;
                          height: 36px;
                          border-radius: 12px;
                          display: grid;
                          place-items: center;
                          background: #ffe9e9;
                          color: #b41616;
                        "
                      >
                        <i class="fa-solid fa-rotate-left"></i>
                      </div>
                      <div>
                        <strong>Refund request received</strong>
                        <small style="display: block; color: var(--muted)"
                          >Please review the case</small
                        >
                      </div>
                      <i
                        class="fa-solid fa-ellipsis-vertical"
                        style="color: #9aa5b5"
                      ></i>
                    </div>
                    <div
                      class="note"
                      style="
                        display: grid;
                        grid-template-columns: 36px 1fr auto;
                        align-items: center;
                        gap: 12px;
                        padding: 12px;
                        border-radius: 14px;
                        border: 1px solid var(--line);
                        background: color-mix(
                          in oklab,
                          var(--card) 96%,
                          white 4%
                        );
                      "
                    >
                      <div
                        class="dot blue"
                        style="
                          width: 36px;
                          height: 36px;
                          border-radius: 12px;
                          display: grid;
                          place-items: center;
                          background: #eaf2ff;
                          color: #19398c;
                        "
                      >
                        <i class="fa-regular fa-calendar"></i>
                      </div>
                      <div>
                        <strong>Robotics club meetup today</strong>
                        <small style="display: block; color: var(--muted)"
                          >Don‚Äôt forget to RSVP</small
                        >
                      </div>
                      <i
                        class="fa-solid fa-ellipsis-vertical"
                        style="color: #9aa5b5"
                      ></i>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Snapshot of Applications -->
              <div class="card">
                <div class="card-body">
                  <div
                    style="
                      display: flex;
                      align-items: center;
                      justify-content: space-between;
                      gap: 10px;
                      margin-bottom: 8px;
                    "
                  >
                    <h3 style="font-size: 18px">Your Applications</h3>
                    <a
                      href="#"
                      data-goto="apps"
                      class="chip"
                      style="padding: 8px 10px"
                      >See all</a
                    >
                  </div>
                  <div class="list" id="appsSnapshot"></div>
                </div>
              </div>
            </section>

            <!-- APPLICATIONS -->
            <section id="page-apps" class="page">
              <iframe
                id="trackingFrame"
                src=""
                style="width: 100%; border: none; background: transparent"
              ></iframe>
            </section>

            <!-- PROFILE -->
            <section id="page-profile" class="page">
              <div class="card">
                <div class="card-body">
                  <h1 style="font-size: 22px">My Profile</h1>
                  <p style="color: var(--muted); margin-top: 4px">
                    View your details. Click Edit to change allowed fields.
                  </p>

                  <form
                    id="profileForm"
                    class="split"
                    autocomplete="off"
                    style="margin-top: 14px"
                  >
                    <div>
                      <label for="full_name">Full Name</label>
                      <input id="full_name" type="text" disabled />

                      <label for="email" style="margin-top: 12px">Email</label>
                      <input id="email" type="email" disabled />

                      <label for="student_number" style="margin-top: 12px"
                        >Student Number</label
                      >
                      <input id="student_number" type="text" disabled />

                      <label for="campus" style="margin-top: 12px"
                        >Campus</label
                      >
                      <input id="campus" type="text" disabled />

                      <label for="college" style="margin-top: 12px"
                        >College</label
                      >
                      <input id="college" type="text" disabled />
                    </div>

                    <div>
                      <label for="course">Course</label>
                      <input id="course" type="text" disabled />

                      <label for="birthdate" style="margin-top: 12px"
                        >Birthdate</label
                      >
                      <input id="birthdate" type="date" disabled />

                      <label for="age" style="margin-top: 12px">Age</label>
                      <input id="age" type="number" disabled />

                      <label for="phone_number" style="margin-top: 12px"
                        >Phone Number</label
                      >
                      <input id="phone_number" type="text" disabled />
                    </div>

                    <div class="form-actions">
                      <button type="button" class="btn edit" id="editBtn">
                        Edit
                      </button>
                      <button
                        type="button"
                        class="btn save"
                        id="saveBtn"
                        style="display: none"
                      >
                        Save
                      </button>
                      <button
                        type="button"
                        class="btn cancel"
                        id="cancelBtn"
                        style="display: none"
                      >
                        Cancel
                      </button>
                    </div>
                  </form>
                </div>
              </div>

              <div class="card" style="margin-top: var(--gap)">
                <div class="card-body">
                  <h2 style="font-size: 18px">Requirements Status</h2>
                  <ul
                    id="reqList"
                    style="
                      margin-top: 8px;
                      color: var(--muted);
                      padding-left: 18px;
                    "
                  >
                    <li>Loading‚Ä¶</li>
                  </ul>
                </div>
              </div>
            </section>

            <!-- SCHOLARSHIPS -->
            <!-- SCHOLARSHIPS -->

            <section id="page-scholarships" class="page">
              <div class="card">
                <div class="card-body">
                  <button
                    id="scholarshipBackBtn"
                    class="btn"
                    style="display: none; margin-bottom: 10px"
                  >
                    ‚Üê Back to Available Scholarships
                  </button>

                  <!-- Scholarship content sandboxed in an iframe -->
                  <iframe
                    id="scholarshipFrame"
                    src=""
                    style="
                      width: 100%;
                      height: 80vh;
                      border: none;
                      margin-top: 16px;
                      border-radius: 12px;
                      background: transparent;
                    "
                  ></iframe>
                </div>
              </div>
            </section>
          </div>
        </div>
      </main>
    </div>

    <!-- Supabase + logic -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      const SUPABASE_URL = "https://qdrnqkoozsloeqzxpgha.supabase.co";
      const SUPABASE_ANON_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFkcm5xa29venNsb2VxenhwZ2hhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk1ODQ5MjgsImV4cCI6MjA3NTE2MDkyOH0.E4Lp4LtyvRfFoImUkZMFyVBM7sro4aoNlQEa7sUIsIs";
      const supabaseClient = window.supabase.createClient(
        SUPABASE_URL,
        SUPABASE_ANON_KEY
      );
      document.addEventListener("DOMContentLoaded", async () => {
        const { data: sessionData, error } =
          await supabaseClient.auth.getSession();
        const user = sessionData?.session?.user;

        if (error) {
          console.error("Failed to get session:", error);
          return;
        }

        if (!user) {
          console.warn("No student logged in.");
          return;
        }

        const studentEmail = user.email;
        fetchNotifications(studentEmail);
      });

      async function fetchNotifications(studentEmail) {
        const notiList = document.getElementById("notiList");
        if (!notiList) return;

        notiList.innerHTML = "<p>Loading notifications...</p>";

        const { data, error } = await supabaseClient
          .from("applicants_iskolar")
          .select("message, scholarship_program, created_at")
          .eq("email", studentEmail)
          .not("message", "is", null)
          .order("created_at", { ascending: false });

        if (error) {
          console.error("Error fetching notifications:", error);
          notiList.innerHTML = "<p>Failed to load notifications.</p>";
          return;
        }

        if (!data || data.length === 0) {
          notiList.innerHTML = "<p>No notifications yet.</p>";
          return;
        }

        notiList.innerHTML = "";
        data.forEach((item) => {
          const div = document.createElement("div");
          div.className = "note";
          div.style =
            "display:grid; grid-template-columns: 36px 1fr auto; align-items:center; gap:12px; padding: 12px; border-radius: 14px; border:1px solid var(--line); background: color-mix(in oklab, var(--card) 96%, white 4%);";

          div.innerHTML = `
      <div class="dot yellow" style="width:36px;height:36px;border-radius:12px;display:grid;place-items:center;background:#FFF7E6;color:#9A6A00;">
        <i class="fa-regular fa-bell"></i>
      </div>
      <div>
        <strong>${item.message}</strong>
        <small style="display:block;color:var(--muted)">Related to: ${
          item.scholarship_program || "General"
        }</small>
      </div>
      <i class="fa-solid fa-ellipsis-vertical" style="color:#9AA5B5"></i>
    `;
          notiList.appendChild(div);
        });
      }

      // Shorthand
      const $ = (s) => document.querySelector(s);
      const $$ = (s) => Array.from(document.querySelectorAll(s));

      // === THEME ===
      const modeToggle = $("#modeToggle");
      const modeIcon = $("#modeIcon");
      const modeLabel = $("#modeLabel");

      function updateModeUI() {
        const isDark = document.body.classList.contains("dark");
        modeIcon.textContent = isDark ? "üåô" : "‚òÄÔ∏è";
        modeLabel.textContent = isDark ? "Dark mode" : "Light mode";
        modeToggle?.setAttribute("aria-pressed", String(isDark));
      }

      function applySavedTheme() {
        const saved = localStorage.getItem("theme");
        const isDark = saved
          ? saved === "dark"
          : window.matchMedia("(prefers-color-scheme: dark)").matches;
        document.body.classList.toggle("dark", isDark);
        updateModeUI();
      }

      applySavedTheme();

      modeToggle?.addEventListener("click", () => {
        const isDark = document.body.classList.toggle("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
        updateModeUI();
      });

      // === NAVIGATION ===
      function show(page) {
        $$(".nav li").forEach((li) => li.classList.remove("active"));
        const li = document.querySelector(`.nav li[data-page="${page}"]`);
        if (li) li.classList.add("active");
        $$(".page").forEach((p) => p.classList.remove("active"));
        const pageEl = document.getElementById(`page-${page}`);
        if (pageEl) pageEl.classList.add("active");
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      $$(".nav li").forEach((li) =>
        li.addEventListener("click", (e) => {
          e.preventDefault();
          show(li.dataset.page);
        })
      );

      document.addEventListener("click", (e) => {
        const goto = e.target.closest("[data-goto]");
        if (goto) {
          e.preventDefault();
          show(goto.dataset.goto);
        }
      });

      // === DATE ===
      (function () {
        const now = new Date();
        $("#todayChip").textContent = now.toLocaleDateString(undefined, {
          weekday: "short",
          day: "numeric",
          month: "long",
          year: "numeric",
        });
      })();

      // === PROFILE ===
      const editBtn = $("#editBtn");
      const saveBtn = $("#saveBtn");
      const cancelBtn = $("#cancelBtn");

      const editable = ["full_name", "password", "phone_number", "age"];
      const allFields = [
        "full_name",
        "email",
        "password",
        "campus",
        "college",
        "course",
        "student_number",
        "phone_number",
        "birthdate",
        "age",
      ];

      let currentUserEmail = null;
      let currentCampus = null;
      let originalData = {}; // store original data for cancel

      // Enable editing
      editBtn?.addEventListener("click", () => {
        editable.forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.disabled = false;
        });
        editBtn.style.display = "none";
        saveBtn.style.display = "inline-block";
        cancelBtn.style.display = "inline-block";
      });

      // Cancel editing ‚Äî restore original data
      cancelBtn?.addEventListener("click", () => {
        editable.forEach((id) => {
          const el = document.getElementById(id);
          if (el) {
            el.value = originalData[id] ?? "";
            el.disabled = true;
          }
        });
        saveBtn.style.display = "none";
        cancelBtn.style.display = "none";
        editBtn.style.display = "inline-block";
      });

      // Disable editing helper
      function disableEdit() {
        editable.forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.disabled = true;
        });
        saveBtn.style.display = "none";
        cancelBtn.style.display = "none";
        editBtn.style.display = "inline-block";
      }

      // Save profile updates
      saveBtn?.addEventListener("click", async () => {
        const {
          data: { user },
        } = await supabaseClient.auth.getUser();
        if (!user) {
          alert("Not logged in.");
          return;
        }

        const updates = {};
        editable.forEach((id) => {
          const el = document.getElementById(id);
          if (el) updates[id] = el.value.trim();
        });
        updates.updated_at = new Date().toISOString();

        // Update in main applicant table
        const { error: mainError } = await supabaseClient
          .from("applicants_main")
          .update(updates)
          .eq("email", user.email);

        if (mainError) {
          console.error(mainError);
          alert("Failed to update main applicant table.");
          return;
        }

        // Update in campus-specific table
        if (currentCampus) {
          const campusTable = `applicants_${currentCampus}`;
          const { error: campusError } = await supabaseClient
            .from(campusTable)
            .update(updates)
            .eq("email", user.email);

          if (campusError) {
            console.warn(
              `Updated main table but failed updating ${campusTable}`,
              campusError
            );
          }
        }

        alert("Profile updated successfully!");
        disableEdit();
        loadProfile(); // refresh data
      });

      async function loadCounts() {
        const { data: sessionData } = await supabaseClient.auth.getSession();
        const user = sessionData?.session?.user;

        if (!user) {
          console.log("No logged in user");
          return;
        }

        const email = user.email;

        const { data: apps, error } = await supabaseClient
          .from("applicants_iskolar")
          .select("status")
          .eq("email", email);

        if (error) {
          console.error(error);
          return;
        }

        let approved = 0,
          pending = 0,
          rejected = 0;

        apps.forEach((row) => {
          const status = row.status?.toLowerCase();
          if (status === "approved") approved++;
          else if (status === "pending") pending++;
          else if (status === "rejected") rejected++;
        });

        const total = approved + pending + rejected; // ‚úÖ Compute total

        // ‚úÖ Update pills
        document.getElementById("mApproved").textContent = approved;
        document.getElementById("mPending").textContent = pending;
        document.getElementById("mRejected").textContent = rejected;
        document.getElementById("mUpcoming").textContent = total; // ‚úÖ Update total
      }

      document.addEventListener("DOMContentLoaded", loadCounts);

      // Load user profile data (read-only by default)
      async function loadProfile() {
        const {
          data: { user },
        } = await supabaseClient.auth.getUser();
        if (!user) {
          window.location.replace("login-signup.html"); // silent redirect, no popup
          return;
        }

        currentUserEmail = user.email;

        const { data: mainData, error: mainError } = await supabaseClient
          .from("applicants_main")
          .select("*")
          .eq("email", user.email)
          .single();

        if (mainError || !mainData) {
          console.error(mainError);
          alert("Error loading profile data.");
          return;
        }

        // Determine and clean campus name for use in table
        currentCampus = (mainData.campus || "")
          .trim()
          .toLowerCase()
          .replace(/^prmsu\s*/i, "")
          .replace(/\s+/g, "");

        let campusData = null;

        if (!currentCampus) {
          console.warn(
            "‚ö†Ô∏è No campus found in mainData, skipping campus fetch."
          );
        } else {
          const { data: cData, error: campusError } = await supabaseClient
            .from("applicants_main") // ‚úÖ Your actual table name
            .select("*")
            .eq("campus", mainData.campus) // use original formatting to match DB
            .eq("email", user.email)
            .maybeSingle();

          console.log("Campus table name:", "applicants_main");
          console.log("Campus being searched:", mainData.campus);

          if (campusError) {
            console.error("‚ùå Campus fetch error details:", campusError);
          } else if (!cData) {
            console.warn("‚ö†Ô∏è No record found for this user and campus.");
          } else {
            console.log("‚úÖ Applicant found:", cData);
            campusData = cData;
          }
        }

        // ‚úÖ Merge both data sources
        const data = { ...mainData, ...(campusData || {}) };
        originalData = { ...data };

        // ‚úÖ Update sidebar greeting here (inside the same async function)
        document.getElementById("sbName").textContent =
          data.full_name || "Student";
        document.getElementById("hiName").textContent =
          data.full_name?.split(" ")[0] || "there";

        // ‚úÖ Now populate the form fields ‚Äî this must be INSIDE the same function
        allFields.forEach((id) => {
          const el = document.getElementById(id);
          if (el && data[id] !== undefined) el.value = data[id] ?? "";
          if (el) el.disabled = true;
        });
      }

      // Button states
      saveBtn.style.display = "none";
      cancelBtn.style.display = "none";
      editBtn.style.display = "inline-block";

      loadProfile();

      $("#logoutBtn")?.addEventListener("click", async () => {
        try {
          await supabaseClient.auth.signOut();
        } catch (_) {}
        localStorage.clear();
        location.href = "login-signup.html";
      });

      const scholarshipContainer =
        document.getElementById("scholarshipContent");

      // This function loads the HTML file and inserts it into the container

      async function loadScholarshipPage() {
        try {
          // Always find the element inside the function
          const scholarshipContainer = document.getElementById(
            "scholarshipContainer"
          );

          // ‚úÖ If the element does not exist, stop early to avoid errors
          if (!scholarshipContainer) {
            // console.error("‚ùå Element with ID 'scholarshipContainer' not found in the DOM.");
            return;
          }

          // Load scholarship.html
          const response = await fetch("scholarship.html");
          if (!response.ok) throw new Error("Failed to load scholarship.html");

          const html = await response.text();
          scholarshipContainer.innerHTML = html;
        } catch (err) {
          const scholarshipContainer = document.getElementById(
            "scholarshipContainer"
          );
          if (scholarshipContainer) {
            scholarshipContainer.innerHTML =
              '<p style="color:red;">Error loading scholarship.html</p>';
          }
          console.error(err);
        }
      }

      // Only load once when user first clicks "Scholarships"
      let scholarshipLoaded = false;
      const scholarshipTab = document.querySelector(
        '[data-page="scholarships"]'
      );
      if (scholarshipTab) {
        scholarshipTab.addEventListener("click", () => {
          if (!scholarshipLoaded) {
            loadScholarshipPage();
            scholarshipLoaded = true;
          }
        });
      }

      const pages = document.querySelectorAll(".page");
      const navItems = document.querySelectorAll("nav li[data-page]");

      navItems.forEach((item) => {
        item.addEventListener("click", () => {
          const targetPage = item.getAttribute("data-page");

          // Hide all pages
          pages.forEach((page) => page.classList.remove("active"));

          // Show selected page
          document.querySelector(`#page-${targetPage}`).classList.add("active");

          // Scroll to top when switching
          window.scrollTo({ top: 0, behavior: "smooth" });

          // Fix possible resizing bug
          setTimeout(() => {
            document.body.style.height = "auto";
            document.querySelector("main").style.height = "auto";
          }, 200);
        });
      });

      document.addEventListener("DOMContentLoaded", () => {
        const scholarshipTab = document.querySelector(
          '[data-page="scholarships"]'
        );
        const scholarshipFrame = document.getElementById("scholarshipFrame");
        const scholarshipBackBtn =
          document.getElementById("scholarshipBackBtn");
        let loaded = false;

        if (scholarshipTab && scholarshipFrame) {
          scholarshipTab.addEventListener("click", () => {
            if (!loaded) {
              scholarshipFrame.src = "scholarship.html"; // load all scholarships
              scholarshipFrame.addEventListener("load", () => {
                try {
                  const doc =
                    scholarshipFrame.contentDocument ||
                    scholarshipFrame.contentWindow.document;
                  if (!doc) return;
                  // hide inner scrollbars and fit height to content
                  if (doc.documentElement)
                    doc.documentElement.style.overflow = "hidden";
                  if (doc.body) {
                    doc.body.style.margin = "0";
                    doc.body.style.padding = "0";
                    doc.body.style.background = "transparent";
                    doc.body.style.overflow = "hidden";
                  }
                  const updateBack = () => {
                    try {
                      const app = doc.getElementById("appEmbed");
                      const show = !!(app && app.style.display === "block");
                      if (scholarshipBackBtn)
                        scholarshipBackBtn.style.display = show
                          ? "inline-block"
                          : "none";
                    } catch (_) {}
                  };
                  const resize = () => {
                    const h = Math.max(
                      doc.body?.scrollHeight || 0,
                      doc.documentElement?.scrollHeight || 0
                    );
                    if (h) scholarshipFrame.style.height = h + "px";
                  };
                  resize();
                  updateBack();
                  const mo = new MutationObserver(() => {
                    resize();
                    updateBack();
                  });
                  mo.observe(doc.documentElement, {
                    childList: true,
                    subtree: true,
                    attributes: true,
                  });
                } catch (_) {
                  /* ignore cross-origin issues */
                }
              });
              loaded = true;
            }
          });
        }

        // Back button -> switch embedded view back to list
        scholarshipBackBtn?.addEventListener("click", () => {
          try {
            const doc =
              scholarshipFrame.contentDocument ||
              scholarshipFrame.contentWindow.document;
            const list = doc.getElementById("list");
            const app = doc.getElementById("appEmbed");
            if (list) list.style.display = "block";
            if (app) app.style.display = "none";
            scholarshipBackBtn.style.display = "none";
            scholarshipFrame.contentWindow?.scrollTo?.(0, 0);
          } catch (_) {
            // fallback: reload to scholarships list
            scholarshipFrame.src = "scholarship.html";
          }
        });
      });

      document.addEventListener("DOMContentLoaded", () => {
        const appsTab = document.querySelector('[data-page="apps"]');
        const trackingFrame = document.getElementById("trackingFrame");
        let loadedTracking = false;

        if (appsTab && trackingFrame) {
          appsTab.addEventListener("click", () => {
            if (!loadedTracking) {
              trackingFrame.src = "tracking.html";
              trackingFrame.addEventListener("load", () => {
                try {
                  const doc =
                    trackingFrame.contentDocument ||
                    trackingFrame.contentWindow.document;
                  if (!doc) return;
                  // minimize extra space/background so only the inner card is visible
                  if (doc.body) {
                    doc.body.style.margin = "0";
                    doc.body.style.padding = "0";
                    doc.body.style.background = "transparent";
                  }
                  // auto-size to content height
                  const resize = () => {
                    const h = Math.max(
                      doc.body?.scrollHeight || 0,
                      doc.documentElement?.scrollHeight || 0
                    );
                    if (h) trackingFrame.style.height = h + "px";
                  };
                  resize();
                  // observe for dynamic changes
                  const mo = new MutationObserver(() => resize());
                  mo.observe(doc.documentElement, {
                    childList: true,
                    subtree: true,
                    attributes: true,
                  });
                } catch (_) {
                  /* cross-origin or other issue; ignore */
                }
              });
              loadedTracking = true;
            }
          });
        }
      });
    </script>
  </body>
</html>
